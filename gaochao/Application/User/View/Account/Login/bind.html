<extend name="Account/base" />
<block name="head_change">
<?php
	$title="新用户注册";
?>
</block>
<block name="body">
	<!--	注册  S-->
	<div class="container clearfix">
		<div class="pull-left top_log">
			<a href="<?=U('/')?>"><img src="__IMG__/logo.png"></a><span>绑定账号</span>
		</div>
	</div>
	<div class="container">
		<div class="transition">
			<div class="top">亲爱的<?=session('sdk_nickname')?>，您已成功验证了<?=$type?>！马上绑定网账号，下次登录更便捷哦~</div>
			<div class="col-md-12 outer outershadow">
				<div class="topbox clearfix">
					<ul class="js_checkpage clearfix">
						<li class="active"><span>您已有账号</span></li>
						<li><span>您没有账号</span></li>
					</ul>
				</div>
				<ul class="loginbox clearfix">
					<li class="has">
						<form class="js_form" action="<?=U('login')?>" func="Login" method="post">
							<input type="hidden" name="is_check_verify" class="is_check_verify" value="0">
							<div class="form-group frame  clearfix">
								<div class="icon" style="background-image:url(__USER__/img/public/icons/persons.png);"></div>
								<input type="text" name="account" class="form-control" placeholder="手机号" datatype="m" nullmsg="请填写手机号" errormsg="请输入正确的手机号" value="" />
							</div>
							<div class="form-group frame clearfix">
								<div class="icon" style="background-image:url(__USER__/img/public/icons/locks.png);"></div>
								<input type="password" name="password" class="form-control" placeholder="密码" value="" datatype="*" nullmsg="请输入密码" />
							</div>
							<div class="form-group clearfix" style="margin:0;">
								<span class="text pull-left js_checkbox remember"><i class="iconfont">&#xe607;</i><input name="remember" type="hidden" value="0" /> 记住密码</span>
								</label style="font-weight:100;">
								<div class="pull-right">
									<a href="<?=U('User/Public/forget')?>">忘记密码</a>
								</div>
							</div>
							<div class="clearfix js_verify_box" style="display:none;">
								<input type="text" name="verify" class="frame pull-left form-control" value="" datatype="*" nullmsg="请输入验证码" errormsg="验证码错误" style="width:100px;margin-right:5px;" />
								<div class="pull-left verifyimg js_verifyimg"><img src="<?=U('User/Public/verify')?>" style="margin-right:5px;" width="120" height="34" title="看不清楚换一张" alt="验证码" />看不清楚，换一张</div>
							</div>
							<div class="form-group psw_promot clearfix">
								<div class="pull-left js_validTips" style="display:none;"><span class="js_tipContent Validform_checktip"></span></div>
							</div>
							<div>
								<input type="submit" class="btn btn-orange btn-block btn-md" value="立即登录" />
							</div>
						</form>
					</li>
					<li class="none" style="display: none;">
						<form class="js_form" action="<?=U('register')?>" method="post">
							<div class="form-group frame  clearfix">
								<div class="icon" style="background-image:url(__USER__/img/public/icons/persons.png);"></div>
								<input type="text" name="account" class="form-control js_account" placeholder="手机号" datatype="m|e" nullmsg="请填写手机号" errormsg="请输入正确的手机号" value="" />
							</div>
							<div class="form-group frame clearfix">
								<div class="icon" style="background-image:url(__USER__/img/public/icons/locks.png);"></div>
								<input type="password" name="password" class="form-control" placeholder="密码" value="" datatype="*6-16" nullmsg="请输入密码" errormsg="密码长度需要再6-16位之间" />
							</div>
							<div class="form-group frame clearfix">
								<div class="icon" style="background-image:url(__USER__/img/public/icons/locks.png);"></div>
								<input type="password" name="repassword" class="form-control" placeholder="确认密码" recheck="password" datatype="*6-16" nullmsg="请再次输入密码" errormsg="确认密码请与密码保持一致" />
							</div>
							<div class="form-group clearfix">
								<div class="frame pull-left" style="width:200px;margin-right:5px;position:relative;">
									<div class="icon" style="background-image:url(__USER__/img/public/icons/phone_icon.png);"></div>
									<input type="text" name="verify" class="form-control" value="" datatype="*" nullmsg="请输入验证码" errormsg="验证码错误" />
								</div>
								<div class="pull-right" style="width:150px">
									<a href="#" class="js_getcode btn btn-success btn-block" url="<?=U('User/Public/getCode/type/1')?>">发送验证码到手机</a>
								</div>
							</div>
							<div class="form-group text reader clearfix">
								<span class="text js_checkbox remember">
									<i class="iconfont">&#xe607;</i>
									<input name="reader" type="hidden" value="0" />
									我已阅读，并同意<a href="<?=U('user')?>" title="用户注册协议" class="dialog">《网用户服务协议》</a>
								</span>
							</div>
							<div class="form-group psw_promot clearfix">
								<div class="pull-left js_validTips" style="display:none;"><span class="js_tipContent Validform_checktip"></span></div>
							</div>
							<div>
								<input type="submit" class="btn btn-orange btn-block btn-md" value="立即注册" />
							</div>
						</form>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!--	注册  E-->
</block>

<block name="script">
<script type="text/javascript">
$(function(){
	//延时重置表单
	setTimeout(function(){$('.js_form')[0].reset()},100);
	
	$('.js_checkpage').on('click','li',function(){
		$(this).addClass('active');
		$(this).siblings().removeClass('active');
		var index = $(this).index();
		$('.loginbox').find('li').eq(index).css({'display':'block'});
		$('.loginbox').find('li').eq(index).siblings().css({'display':'none'});
	});
	$('.js_checkbox').on('click',function(){
		var obj = $(this).find('i');
		if(obj.hasClass('hover')){
			obj.removeClass('hover').html("&#xe607;");
			$(this).find("input").val(0);
		}else{
			obj.addClass('hover').html("&#xe609;");
			$(this).find("input").val(1);
		}
		obj = null;
	});

	$('.js_check').on('click','li',function(){
		$(this).addClass('active');
		$(this).siblings().removeClass('active');
		var index = $(this).index();
		if(index == 0){
			$('.js_type').val('user');
			// $('.others').css({'display':'block'});
		}else if(index == 1){
			$('.js_type').val('business');
			// $('.others').css({'display':'none'});
		}
	});
	$(".js_verifyimg").click(function(){
		var obj=$(this);
		if($(this).is("img")==false){
			obj=$(this).find("img");
		}
		var verifyimg = obj.attr("src");
		if( verifyimg.indexOf('?')>0){
			obj.attr("src", verifyimg+'&random='+Math.random());
		}else{
			obj.attr("src", verifyimg.replace(/\?.*$/,'')+'?'+Math.random());
		}
	});
	//下拉选择类型列表
	$(".form_select").click(function(){
		if($(this).find(".select_type").is(":hidden")){
			$(this).find("img").eq(1).attr("src","__USER__/img/public/icons/select_arrow.png");
		}else{
			$(this).find("img").eq(1).attr("src","__USER__/img/public/icons/unselect_arrow.png");
		}
		$(this).find(".select_type").slideToggle(100);
		$(".select_type li").click(function(){
			var li_text=$(this).text();
			var a_img=$(".select_type").siblings("a").find("img");
			$(".select_type").siblings("a").text(li_text).append(a_img);
			$(".select_type").parent().find("input[type=hidden]").val($(this).attr("data-value"));
		})
	})

})

var n=0;
function afterCallbackLogin(curform,data){
	if(data.status!=1){
		if(n>=3){
			$(".is_check_verify").val(1);
			$(".js_verify_box").slideDown(100);
		}else{
			n++;
		}
		$(".js_verifyimg").click();
		$(".js_tipsContent").text(data.info);
		$(".js_tips").fadeIn();
		curform.find("input[type=submit]").removeClass('disable').attr('autocomplete', 'off').prop('disabled',false);
		return false;
	}else{
		$(".js_tips").removeClass("alert-danger").addClass("alert-success");
		return true;
	}
}
</script>
</block>